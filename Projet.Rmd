---
title: "Untitled"
author: "Batista Reda"
date: "13/12/2021"
output: pdf_document
---
```{r}
library(SciViews)   
library(Ryacas) 
library(corrplot)  
library("FactoMineR") 
library("factoextra")
```

## Exercice 4 

L'objectif de cette exercice est de déterminer la moyenne et l'écart-type de la distance en mètre parcourus par un javelot. On sait que X qui définie la distance parcourus par un javelot en mètre suit une loi normale. 
On utilise qnorm pour simuler une loi normale centrée réduite et déterminer ensuite la moyenne et l'écart-type. 
```{r} 
qnorm(0.9,0,1)#10% des javelots atteignent plus de 75m
qnorm(0.25,0,1)# 25% des javelots parcourent moins de 50m
```
On obtient un système à deux équations 
75-µ=1.28σ 
25-µ=-0.67σ 
On calcul L1-L2

```{r}
75-50 
qnorm(0.9,0,1)-qnorm(0.25,0,1)
```
Ce qui nous donnes : 25=1.95σ  --> σ =12.8
On remplace dans le système et on obtient : µ=58.7 
La longueur moyenne parcourue par un javelot est de 58.7m et d'écart-type 12.8m  



## Exercice 5  
### Question 1

```{r} 
#Première solution
palindrome<-function(mot){  
  template<-gsub("[\r\n]", "", mot)#On retire les retours chariots 
  template_clean<-gsub(" ", "", template, fixed = TRUE)#Retire les espaces entres les mots 
  asci_clean<-iconv(template_clean, from = '', to = 'ASCII//TRANSLIT')#Change les caractères spéciaux
  cut_mot<-strsplit(asci_clean,split = "")#On sépare individuellement chaque lettre
  reversed_mot<-paste(rev(cut_mot[[1]]), collapse="")#On recolle en inversant l'ordre 
  if (asci_clean == reversed_mot) {#On compare avec l'original
      cat(mot,"est un palindrome\n",sep=" ") 

  } else {
      cat(mot,"n'est pas un palindrome\n",sep = " ")
  }
} 
```


### Question 2 
```{r}
liste_mot<-list("radar","bonne année", "sept", "kayak", "la mariée ira mal", "statistiques", "engage le jeu que je le gagne", "esope reste ici et se repose")
for(mot in liste_mot){
  palindrome(mot)
}

```

### Question 3 

```{r}
palindrome_9<-function(liste){  
  if (typeof(liste)=="list"){#si l'objet est une liste
    for(mot in liste){  
      template<-gsub(" ", "", mot, fixed = TRUE)#Retire les espaces entres les mots  
      if (nchar(template)<=9 & nchar(template)>2){ 
        palindrome(mot)} 
      else{
        cat(mot,"est supérieur à 9 lettres ou inférieur à 2 lettres\n",sep = " ")
      }
    }
  } else{#Si l'objet est un mot simple
  template<-gsub(" ", "", mot, fixed = TRUE)#Retire les espaces entres les mots  
  if (nchar(template)<=9 & nchar(template)>2){ 
    palindrome(mot)} 
  else{
    cat(mot,"est supérieur à 9 lettres ou inférieur à 2 lettres\n",sep = " ")
   }
  }
}


palindrome_9(liste_mot)

```





## Exercice 6 
### Question 1
```{r}  
f <- function(x) {x^2*(ln(x))^n}

for (n in c(1:10)) {  
  results<-integrate(f, lower = 1, upper = exp(1))
  print(results)
  } 
```
### Question 2 
```{r}   
x <- ysym("x") 
integrate(sin(x), x)
 
```


```{r}  
f_n <- function(x) {
  tmp<-Vectpr
}  
f_n<-Vectorize(f_n)
n <- ysym("n") 
lim(integrate(f_n, lower = 1, upper = exp(1))$value, n, Inf) 


    
```


##Exercice 7 
### Question 1 
#### Data avec les deux dernières lignes en moins
```{r}
data<-read.csv("données.csv",header = TRUE,sep=";")#Chargement des données  
data_2<-data[-c(19, 20) ]
data_2<-data_2[-1]  
data_cor<-cor(data_2) 
```

### Question 2
```{r}
corrplot(data_cor, method = 'color') # Heatmap de correlation
```
Le plot ci-contre montre la matrice de corrélation sous forme de heatmap. Les valeurs les plus corrélées sont 1 et -1. Pour les valeurs égales à -1 la corrélation est inverse (une variable augmente l'autre diminue) pour les valeurs égales à 1 la corrélation est cojointe (les deux variables augmentes ensemble) et pour 0 les variables ne sont pas corrélés. Ici les valeurs les plus corrélées sont en rouge brique ou en bleu marine. 

### Question 3 

```{r}
res.pca <- PCA(data_cor, graph = FALSE) 
eig.val <- get_eigenvalue(res.pca) 
fviz_eig(res.pca, addlabels = TRUE, ylim = c(0, 100))
```

Au vu des résultats, on garde les deux premières valeurs (il faut obligatoirement deux valeurs) on ne prend pas la troisième que l'on considère comme négligéable. 

### Question 4   

```{r}
# Contributions des variables à PC1
fviz_contrib(res.pca, choice = "var", axes = 1, top = 10)
# Contributions des variables à PC2
fviz_contrib(res.pca, choice = "var", axes = 2, top = 10) 
#Contribution totale des variables 
fviz_contrib(res.pca, choice = "var", axes = 1:2, top = 10)
```


### Question 5

```{r}
fviz_pca_var(res.pca, col.var = "black")
```

Les flèches qui composent la premier PCA sont celle qui appartiennent au colonne avec la lettre c devant les années 

### Question 6 

### Question 7 
```{r}
# Contribution totale sur PC1 et PC2
# Contributions des variables à PC1
fviz_contrib(res.pca, choice = "ind", axes = 1, top = 10)
# Contributions des variables à PC2
fviz_contrib(res.pca, choice = "ind", axes = 2, top = 10) 
#Contribution totale des variables 
fviz_contrib(res.pca, choice = "ind", axes = 1:2, top = 10)
```


#### Data avec les deux dernières lignes    

### Question 1 
```{r}
data<-read.csv("données.csv",header = TRUE,sep=";")#Chargement des données  
data2_2<-data[19:20,]
data2_2<-data2_2[-1]  
data2_2cor<-cor(data2_2) 
```

### Question 2
```{r}
corrplot(data2_2cor, method = 'color') # Heatmap de correlation
```
Le plot ci-contre montre la matrice de corrélation sous forme de heatmap. Les valeurs les plus corrélées sont 1 et -1. Pour les valeurs égales à -1 la corrélation est inverse (une variable augmente l'autre diminue) pour les valeurs égales à 1 la corrélation est cojointe (les deux variables augmentes ensemble) et pour 0 les variables ne sont pas corrélés. Ici les valeurs les plus corrélées sont en rouge brique ou en bleu marine. 

### Question 3 

```{r}
res.pca_2 <- PCA(data2_2cor, graph = FALSE) 
eig.val_2 <- get_eigenvalue(res.pca_2) 
fviz_eig(res.pca_2, addlabels = TRUE, ylim = c(0, 100))
```

Au vu des résultats, on garde les deux premières valeurs (il faut obligatoirement deux valeurs) on ne prend pas la troisième que l'on considère comme négligéable. 

### Question 4   

```{r}
# Contributions des variables à PC1
fviz_contrib(res.pca_2, choice = "var", axes = 1, top = 10)
# Contributions des variables à PC2
fviz_contrib(res.pca_2, choice = "var", axes = 2, top = 10) 
#Contribution totale des variables 
fviz_contrib(res.pca_2, choice = "var", axes = 1:2, top = 10)
```


### Question 5

```{r}
fviz_pca_var(res.pca_2, col.var = "black")
```

Les flèches qui composent la premier PCA sont celle qui appartiennent au colonne avec la lettre c devant les années 

### Question 6 

### Question 7 
```{r}
# Contribution totale sur PC1 et PC2
# Contributions des variables à PC1
fviz_contrib(res.pca_2, choice = "ind", axes = 1, top = 10)
# Contributions des variables à PC2
fviz_contrib(res.pca_2, choice = "ind", axes = 2, top = 10) 
#Contribution totale des variables 
fviz_contrib(res.pca_2, choice = "ind", axes = 1:2, top = 10)
```


